<!-- Standard Details Modal Component (for viewing detailed information) -->
{% macro details_modal(modal_id, entity_name, size="lg", icon_class="mdi-information") %}
<div class="modal fade" id="{{ modal_id }}" tabindex="-1" role="dialog" aria-labelledby="{{ modal_id }}Label" aria-hidden="true">
  <div class="modal-dialog modal-{{ size }}" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="{{ modal_id }}Label">
          <i class="mdi {{ icon_class }} mr-2"></i>
          <span id="{{ modal_id }}Title">{{ entity_name }} Details</span>
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="{{ modal_id }}Body">
        <div class="text-center p-4">
          <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading...</span>
          </div>
          <p class="mt-2 text-muted">Loading {{ entity_name.lower() }} details...</p>
        </div>
      </div>
      <div class="modal-footer" id="{{ modal_id }}Footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>
// @ts-nocheck
// eslint-disable
/* jshint ignore:start */
// Standard details modal function
function show{{ entity_name.replace(' ', '') }}Details(id, data = null, title = null) {
    const modal = document.getElementById('{{ modal_id }}');
    const titleElement = document.getElementById('{{ modal_id }}Title');
    const bodyElement = document.getElementById('{{ modal_id }}Body');
    
    // Set title
    if (title) {
        titleElement.textContent = title;
    } else {
        titleElement.textContent = '{{ entity_name }} Details';
    }
    
    // Show loading initially
    bodyElement.innerHTML = `
        <div class="text-center p-4">
            <div class="spinner-border text-primary" role="status">
                <span class="sr-only">Loading...</span>
            </div>
            <p class="mt-2 text-muted">Loading {{ entity_name.lower() }} details...</p>
        </div>
    `;
    
    // Show modal
    $('#{{ modal_id }}').modal('show');
    
    // If data is provided, use it directly
    if (data) {
        populate{{ entity_name.replace(' ', '') }}Details(data);
    } else if (id) {
        // Otherwise fetch data
        fetch{{ entity_name.replace(' ', '') }}Details(id);
    }
}

// Function to populate modal with data (to be customized per implementation)
function populate{{ entity_name.replace(' ', '') }}Details(data) {
    const bodyElement = document.getElementById('{{ modal_id }}Body');
    
    // Default implementation - override this function for custom display
    let html = '<div class="row">';
    
    Object.keys(data).forEach(key => {
        if (data[key] !== null && data[key] !== undefined && data[key] !== '') {
            const label = key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            html += `
                <div class="col-md-6 mb-3">
                    <strong>${label}:</strong><br>
                    <span class="text-muted">${data[key]}</span>
                </div>
            `;
        }
    });
    
    html += '</div>';
    bodyElement.innerHTML = html;
}

// Function to fetch data (to be customized per implementation)
async function fetch{{ entity_name.replace(' ', '') }}Details(id) {
    try {
        // This should be overridden with the actual API endpoint
        const response = await fetch(`/api/{{ entity_name.lower().replace(' ', '-') }}/${id}`);
        const result = await response.json();
        
        if (response.ok) {
            populate{{ entity_name.replace(' ', '') }}Details(result.data || result);
        } else {
            throw new Error(result.detail || result.message || 'Failed to load details');
        }
    } catch (error) {
        console.error('Error fetching {{ entity_name.lower() }} details:', error);
        const bodyElement = document.getElementById('{{ modal_id }}Body');
        bodyElement.innerHTML = `
            <div class="alert alert-danger">
                <i class="mdi mdi-alert mr-2"></i>
                <strong>Error:</strong> ${error.message}
            </div>
        `;
    }
}
/* jshint ignore:end */
</script>
{% endmacro %}

<!-- Standard PDF Modal Component (for displaying PDFs) -->
{% macro pdf_modal(modal_id="pdfModal") %}
<div class="modal fade" id="{{ modal_id }}" tabindex="-1" role="dialog" aria-labelledby="{{ modal_id }}Label" aria-hidden="true">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="{{ modal_id }}Label">
          <i class="mdi mdi-file-pdf-box mr-2"></i>
          <span id="{{ modal_id }}Title">PDF Viewer</span>
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <div id="{{ modal_id }}LoadingMessage" class="text-center p-4">
          <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading PDF...</span>
          </div>
          <p class="mt-2">Loading PDF document...</p>
        </div>
        <iframe id="{{ modal_id }}Iframe" 
                style="width: 100%; height: 70vh; border: none; display: none;"
                title="PDF Document Viewer">
        </iframe>
        <div id="{{ modal_id }}ErrorMessage" style="display: none;" class="alert alert-danger m-3">
          <i class="mdi mdi-alert mr-2"></i>
          <strong>Error:</strong> Unable to load PDF document.
        </div>
      </div>
      <div class="modal-footer">
        <button id="{{ modal_id }}DownloadBtn" type="button" class="btn btn-outline-primary" style="display: none;" onclick="downloadCurrentPDF()">
          <i class="mdi mdi-download mr-1"></i>
          Download PDF
        </button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

{% endmacro %}